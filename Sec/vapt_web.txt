
Vulnerability Assessment and Penetration Testing (VAPT)

=> Reconnaissance/Enumeration
- Passive:
    - Network Analysis:
        - Whois Lookup -> whois
        - DNS Records (A, MX, TXT, CNAME, PTR) -> dig, dnsdumpster
        - DNS Zone Transfers (AXFR)
    - Subdomain Enum -> subfinder, amass (passive mode), assetfinder, theHarvester
    - Certificate transparency/logs -> crt.sh, certspotter, ctsearch
    - Headers Analysis (security headers, cookies, server banners) -> shcheck, Mozilla HTTP Observatory
    - SSL/TLS Analysis (check protocol versions, ciphers, HSTS, OCSP stapling) -> testssl, SSLyze, sslscan
    - Technology Fingerprinting:
        - Identify web server, CMS, frameworks, hosting (PaaS, serverless, microservices, static storage)
        - Identify vulnerable software/libraries -> Retire.js
        - Detect reverse proxy, WAF, IPS
        - Tools -> Wappalyzer, BuiltWith, WhatWeb
    - OSINT:
        - Google Dorking (advanced operators) -> Exposed sensitive info, endpoints
        - Wayback Machine and Archives (sites)
        - Google Hacking Database (GHDB)
        - IoT/Search Engines -> Shodan, Censys, ZoomEye
        - Public code/repo scans (GitHub, GitLab) -> gitrob, truffleHog, Gitleaks
        - Public Platform -> Social profiles, job/people postings, blogs, etc.
        - OSINT frameworks -> Recon-ng, Maltego
    - File/Source Code:
        - JavaScript Analysis: Parse & review client-side JS for secrets, API paths, tokens
        - Backup/Config/Cache Files Check: Extensions like .old, .bak, .inc, .src
        - Metadata & Exposed Files: robots.txt, <META> tags, sitemap.xml, .htaccess, sensitive dirs/files
- Active:
    - Hosts Discovery (live hosts) -> ping, nmap, rustscan
    - Port Detection (open ports) -> nmap, masscan, rustscan
    - Service Detection -> nmap
    - DNS Probing/Enum (A, MX, TXT, CNAME, PTR) -> amass, dnsrecon, dnsenum
    - Subdomain Enum: amass, sublist3r, fierce, dnsrecon, dnsenum
    - Content Discovery:
        - Crawlers/URLs Extraction -> waybackurls, gau/gauplus
        - Directory/File Enum -> ffuf, dirsearch, gobuster, dirb/dirbuster
        - Endpoint Extraction (hidden admin panels, APIs, test/staging dirs) -> linkfinder, getJS, SecretFinder, hakrawler, AdminPBuster
        - Parameter Discovery/Fuzzing -> Arjun, ParamSpider, kxss, api-fuzzers/apibuster
    - Forced Browsing:
        - Common Directory (admin panels) -> /admin, /administrator, /backoffice, /backend
        - Ports (alternative ports) -> Tomcat on 8080

=> Penetration Testing
- Input flaws:
    - Identify all input points: Search, Registration/Login, Feedback/Contact forms, Coupon/Gift code fields, File uploads
    - SSTI, HTML injection
    - XSS (Reflected, Stored, DOM) -> In search, reviews, profile updates
    - SQLi (Classic, blind, time-based) -> login, product ID, filters
    - Command Injection -> file upload, image processing
    - XXE/XInclude -> file uploads, XML APIs
    - SSRF -> image fetchers, webhooks, PDF generation
- Authentication & Session:
    - Weak login flows: Default/weak creds, brute-force, password spraying
    - Login/Logout flaws & error-based enumeration (invalid user vs invalid password)
    - Forgot password flows -> token leakage, reset bypass
    - OTP/email verification bypass -> request/response tampering
    - Account lockout & rate-limiting bypass
    - Session flaws: fixation, token reuse, predictable session IDs
    - JWT issues -> insecure alg (none, HS256), weak secrets
    - Cookie security -> missing flags (HttpOnly, Secure, SameSite)
    - CSRF on state-changing requests
    - OAuth/OpenID misconfigurations
    - Race conditions in login/registration flows
- File Upload & Storage:
    - Upload bypasses:
        - Malicious extensions (.php, .php.jpg, .svg)
        - MIME type & content-type validation bypass
    - Post-upload risks:
        - Stored XSS in file preview
        - Direct file access (/uploads/filename.jpg)
        - Unrestricted file download
    - Cloud/Storage checks:
        - Open S3 buckets, misconfigured blob storage
- Business Logic Issues:
    - Rate limiting flaws -> brute-force, OTP abuse
    - Payment bypass, workflow abuse, cart manipulation
    - Race conditions -> multiple coupon/gift card redemption
    - Coupon/discount logic bypass -> stacking, unlimited use
    - Price tampering via client-side manipulation
- Role & Access Control Failures:
    - Privilege Escalation:
        - Access restricted paths (/admin, /superuser)
        - Modify role/permissions in requests
        - Anonymous vs authenticated users
    - IDOR/Broken Object Level Authorization:
        - Access other usersâ€™ orders (/orders/123)
        - Change user_id, product_id, invoice IDs in requests
        - Unauthorized access to invoices, payment details
        - Account/email enumeration
