
Red Teaming

=> Red Teaming

- Red Teaming is a simulated cyberattack performed by ethical hackers to assess an organization’s security from an adversary’s perspective. It involves an independent group (the “red team”) emulating real-world threat actors to evaluate the effectiveness, readiness, and resilience of an organization’s systems, processes, and defenses.
- The objective is not only to find vulnerabilities but also to test detection and response capabilities, identify gaps across people, processes, and technology, and measure true attack preparedness.
- Unlike traditional penetration testing, which focuses mainly on technical flaws, red teaming evaluates the organization’s overall security posture in a realistic attack scenario.


=> MITRE ATT&CK

- MITRE ATT&CK (Adversarial Tactics, Techniques & Common Knowledge) is a globally adopted cybersecurity framework that documents how real-world attackers behave.
- It provides a standardized, evidence-based way to describe attacker actions across the entire attack lifecycle.

Why MITRE ATT&CK Exists
- Before ATT&CK, the security industry lacked a common language to describe hacker behaviors.
- MITRE developed this framework so that:
    - Red Teams can simulate realistic attacks
    - Blue Teams/SOCs can build better detection and response
    - Security tools can map and validate coverage
    - Organizations can identify visibility and control gaps
    - Everyone can communicate using the same vocabulary

Structure of MITRE ATT&CK
MITRE ATT&CK has three layers:
- Tactics:
    - What attackers want to achieve
    - Tactics represent the goal or stage of the attack.
    - There are 14 Tactics, forming the columns of the matrix:
        1. Reconnaissance
        2. Resource Development
        3. Initial Access
        4. Execution
        5. Persistence
        6. Privilege Escalation
        7. Defense Evasion
        8. Credential Access
        9. Discovery
        10. Lateral Movement
        11. Collection
        12. Command & Control
        13. Exfiltration
        14. Impact
- Techniques:
    - How attackers achieve the goal
    - Each tactic contains multiple techniques.
    - Examples:
        | Technique          | ID    | Purpose           |
        | ------------------ | ----- | ----------------- |
        | Phishing           | T1566 | Initial Access    |
        | PowerShell         | T1059 | Execute commands  |
        | Credential Dumping | T1003 | Steal credentials |
        | Remote Services    | T1021 | Lateral Movement  |
- Sub-techniques:
    - More specific variations
    - These describe detailed methods used by attackers.
    - Examples:
        - T1566.001 - Spear-phishing Email
        - T1003.001 - LSASS Memory Dump
        - T1059.001 - PowerShell Execution

Types of MITRE ATT&CK Matrices
MITRE maintains three main matrices:
- Enterprise ATT&CK: Windows, Linux, macOS, Cloud, SaaS, Office 365, Containers
- Mobile ATT&CK: Android, iOS
- ICS ATT&CK: Industrial Control Systems / SCADA

How MITRE ATT&CK Is Used
- Red Teaming (Attack Simulation):
    - Helps build realistic attack chains
    - Common flow: T1566 (Phishing) -> T1059 (PowerShell) -> T1003 (Credential Dumping)
- Blue Team / SOC (Detection & Response):
    - SOCs use ATT&CK to:
        - Create detection logic and alert rules
        - Prioritize logs and telemetry
        - Map coverage and identify gaps
        - Align SIEM detections (Splunk, Sentinel, QRadar, Elastic)
- Threat Intelligence:
    - MITRE maps real threat groups (e.g., APT29, FIN7, Lazarus) to techniques to understand:
        - Their preferred attack methods
        - Common patterns in their operations
- Security Product Evaluation:
    - Products like EDR/XDR are assessed against ATT&CK techniques in MITRE Engenuity evaluations.

Example MITRE Attack Chain
A simulated attack might follow this sequence:
- Initial Access -> T1566.001 (Spear-phishing Email)
- Execution -> T1059.001 (PowerShell)
- Privilege Escalation -> T1068 (Exploitation for PrivEsc)
- Credential Access -> T1003.001 (LSASS Dump)
- Lateral Movement -> T1021.002 (SMB/Remote Services)
- Exfiltration -> T1041 (Exfiltration Over C2 Channel)

Why MITRE ATT&CK Is Important
- Provides a universal language for describing attacks
- Improves detection engineering and SOC maturity
- Helps identify visibility gaps
- Supports threat hunting and incident response
- Widely used by governments, enterprises, and security teams worldwide

MITRE ATT&CK - In Simple Words
- A detailed map of hacker behavior.
- It explains what attackers do and how they do it at every stage of a cyberattack.


=> Cyber Kill Chain

- The Cyber Kill Chain, developed by Lockheed Martin, is a security framework that outlines the seven stages of a cyberattack, from initial preparation to final impact.
- It helps organizations understand attacker behavior, detect threats early, and disrupt attacks at any stage.

Why Cyber Kill Chain Exists
- Before frameworks like MITRE ATT&CK became widely adopted, organizations needed a simple way to understand and break an attack before it caused damage.
- Lockheed Martin developed the Cyber Kill Chain to:
    - Provide a clear, step-by-step model of how cyberattacks progress
    - Help security teams detect attackers early in the process
    - Identify where defenders can disrupt (“kill”) the attack
    - Improve SOC monitoring and incident response
    - Give organizations a common, high-level language for attack stages

The 7 Stages of the Cyber Kill Chain
1. Reconnaissance
    - Information Gathering
    - The attacker collects information to understand the target environment.
    - Examples:
        - Scanning ports and services
        - Identifying employee email addresses
        - OSINT gathering (LinkedIn, social media, website info)
        - Profiling technology stack
    - Goal: Identify weaknesses and plan the attack.
2. Weaponization
    - Creating the Malicious Payload
    - The attacker prepares the exploit or malware to be delivered.
    - Examples:
        - Crafting a phishing email with malware
        - Creating an exploit-injected PDF or document
        - Building payloads such as trojans, ransomware, or RATs
        - Goal: Develop a “weapon” that will compromise the target.
3. Delivery
    - Transmitting the Weapon
    - The attacker delivers the malicious payload to the victim.
    - Examples:
        - Spear-phishing email
        - Malicious USB device
        - Drive-by download link
        - Compromised website
    - Goal: Ensure the target receives or interacts with the malicious content.
4. Exploitation
    - Executing the Payload
    - The attack triggers execution, typically via a vulnerability or user action.
    - Examples:
        - Victim opens a malicious attachment
        - Browser exploit is triggered on a compromised site
        - Malicious macros run in Office files
    - Goal: Execute code to compromise the system.
5. Installation
    - Establishing Foothold
    - Malware is installed to maintain persistent access.
    - Examples:
        - Installing a backdoor or trojan
        - Setting up persistence mechanisms
        - Dropping implants or RATs
    - Goal: Secure long-term access to the compromised system.
6. Command & Control (C2)
    - Remote Access
    - The infected device connects back to the attacker.
    - Examples:
        - Malware beaconing to a C2 server
        - Establishing a reverse shell
        - Creating encrypted communication channels
    - Goal: Allow attackers to remotely control the system.
7. Actions on Objectives
    - Final Mission
    - The attacker performs the intended malicious activity.
    - Examples:
        - Data theft or data exfiltration
        - Ransomware deployment
        - System destruction or sabotage
        - Creating rogue accounts
        - Lateral movement across the network
    - Goal: Achieve the attacker’s ultimate objective.

How the Cyber Kill Chain Is Used
- Threat Detection: SOC teams map alerts to kill chain stages (e.g., Delivery -> suspicious emails, C2 -> beaconing traffic).
- Incident Response: IR teams identify which stage the attacker is in and take targeted action to contain the attack.
- Threat Hunting: Hunters look for patterns along the kill chain—such as scanning (Recon) or malware execution (Exploitation).
- Security Architecture: Organizations design security controls to interrupt each stage (e.g., email filtering for Delivery, AV/EDR for Installation).
- Training & Awareness: Provides a simple and easy-to-understand model for explaining cyberattacks to non-technical teams.

Example Cyber Kill Chain Flow
A typical attacker workflow might look like:
- Reconnaissance -> Collecting employee emails
- Weaponization -> Creating a malicious macro-enabled Excel file
- Delivery -> Sending the file in a phishing email
- Exploitation -> User opens the attachment and enables macros
- Installation -> Malware installs a backdoor
- C2 -> Backdoor connects to attacker’s server
- Actions on Objectives -> Attacker exfiltrates sensitive data

Why the Cyber Kill Chain Is Important
- Helps detect and disrupt attacks at any stage
- Supports incident response, threat hunting, and forensic analysis
- Strengthens SOC visibility and detection strategies
- Provides a clear framework for understanding attack progression

Cyber Kill Chain – In Simple Words
- A step-by-step map of how hackers attack a system.
- If you break any step, you break the attack.


=> Active Directory (AD)

- Active Directory (AD) is Microsoft’s directory service used to manage users, computers, groups, policies, and permissions in a Windows domain network.
- Think of it as the central brain of a corporate network.

It allows organizations to:
- Authenticate & authorize users
- Control access to resources
- Apply security policies
- Manage thousands of systems centrally
- Windows Server hosts the Active Directory service.

Active Directory Domain Services (AD DS)
- This is the main service of AD.
- It provides:
    - Centralized authentication
    - User & computer management
    - Group Policy
    - Access control
    - Directory database
- Everything in AD DS is stored in the NTDS.dit database.
- Active Directory Components
    - Domain
        - A domain is a logical group of: Users. Computers. Servers, Policies
        - Example: company.local
        - Domains are the fundamental building blocks in AD.
    - Domain Controller (DC)
        - A server that runs AD DS.
        - DC stores and manages:
            - User accountsPasswords
            - Authentication (Kerberos)
            - Policies
        - If DC is down -> users cannot log in.
    - Forest
        - A forest contains multiple domains under one umbrella.
        - It is the top-level AD structure.
        - Example: company.local, india.company.local, europe.company.local
        - All domains in a forest trust each other.
    - Tree
        - A group of domains organized in a hierarchy.
    - Organizational Unit (OU)
        - Container used to organize objects.
        - Example OUs: Users, Computers, IT Dept, Finance Dept
        - GPOs are applied to OUs.
    - Objects
        - Everything inside AD is an object.
        - Types: User, Group, Computer, Printer, Service Account
    - Groups
        - Two types of groups:
            - Security groups: Used to assign permissions.
            - Distribution groups: Used for emails (Exchange).
    - Group Policy Objects (GPOs)
        - Rules and settings applied to users and computers.
        - Examples of GPO controls:
            - Disable USB
            - Set password policies
            - Disable CMD/PowerShell
            - Install software
            - Firewall rules
        - Applied to Domains or OUs.

AD Authentication Methods
- Kerberos Authentication
    - Default & most secure.
    - Uses:
        - TGT (Ticket Granting Ticket)
        - Service Tickets
    - Key terms:
        - KDC - Key Distribution Center
        - AS-REQ / AS-REP
        - TGS-REQ / TGS-REP
- NTLM Authentication
    - Older, less secure.
    - Used when:
        - Kerberos fails
        - Workgroup environment
        - Legacy apps

AD Infrastructure Terms
- DNS -> AD heavily depends on DNS
- Sites -> Used for replication control
- Subnets -> Define network boundaries
- AD Replication -> DCs synchronize data
- SYSVOL folder -> Stores GPOs, scripts

Common Active Directory Attacks (Red Team)
- Kerberoasting: Stealing service account tickets and cracking their password offline.
- AS-REP Roasting: Targeting accounts with no Kerberos preauthentication.
- Pass-the-Hash (PtH): Using NTLM hash to authenticate without knowing the password.
- Pass-the-Ticket (PtT): Using Kerberos tickets to impersonate users.
- Golden Ticket Attack: Using the KRBTGT hash to generate fake TGTs (full domain compromise).
- Silver Ticket Attack: Forging service tickets (access to specific services).
- DCSync: Mimicking domain controller replication to steal:
    - NTLM hashes
    - KRBTGT hash
    - Passwords
- Lateral Movement: Moving from one system to another.
    - Tools: PsExec, WinRM, SMB, RDP
- Privilege Escalation:
    - Techniques:
        - Unconstrained delegation
        - Vulnerable GPOs
        - Misconfigured OUs
        - Weak ACL permissions

Tools Used with Active Directory
- For administrators:
    - AD Users and Computers
    - GPMC (Group Policy Management Console)
    - DNS Manager
    - ADSI Edit
    - PowerShell
- For security / red teaming:
    - BloodHound
    - SharpHound
    - Mimikatz
    - Impacket
    - CrackMapExec
    - PingCastle
    - PowerSploit

-----

Nessus
OpenVAS
Blood Hound
Maltego
