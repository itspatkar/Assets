
=> Windows

Windows Directories
- Credential & Security Stores:
    - C:\Windows\System32\config\SAM -> Stores password hashes (protected by SysKey).
    - C:\Windows\repair\SAM -> Backup of user credentials (sometimes used in recovery/forensics).
    - C:\Windows\System32\config\SECURITY -> Contains local security policies & access control data.
- System & Software Logs:
    - C:\Windows\System32\config\SOFTWARE -> Registry hive of installed software (useful in malware analysis).
    - C:\Windows\System32\config\SYSTEM -> Stores system-wide configuration & control settings.
    - C:\Windows\System32\winevt\* -> Windows Event Logs (critical for threat detection & incident response).
- Recon & Persistence Analysis:
    - C:\Windows\Prefetch\ -> Stores app execution traces (great for forensic timelines).
    - C:\Windows\AppCompat\Programs\Amcache.hve -> Records executed applications (useful for malware tracking).
    - C:\Users\*\NTUSER.dat -> Per-user registry hive (often abused for persistence).
- Startup & Execution Tracing:
    - C:\Users\*\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup -> User-level startup folder (commonly abused by malware).
    - C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup -> Startup folder for all users.
- Network Configuration:
    - C:\Windows\System32\drivers\etc\hosts → Local DNS mappings (often abused for redirection).
    - C:\Windows\System32\drivers\etc\networks → Legacy network config file (rarely used today).

Windows Native Features
- Registry (Run Keys / Startup Folder):
    - Legit use: Central database for Windows/system configuration.
    - Attack use: Persistence via Run/RunOnce keys or Startup folder to auto-execute payloads, disable defenses, or store malicious configs.
- Windows Management Instrumentation (WMI):
    - Legit use: Manage and query system information, automation, monitoring.
    - Attack use: Persistence via event subscriptions, stealthy command execution, lateral movement.
- WMIC (Windows Management Instrumentation Command-line):
    - Legit use: CLI to WMI for queries and system management.
    - Attack use: Remote command execution, persistence, reconnaissance without dropping files.
- PowerShell:
    - Legit use: Automation, configuration, scripting for admins.
    - Attack use: Fileless malware execution, credential dumping, payload delivery, obfuscation to evade defenses.
- VB / VBScript (Visual Basic):
    - Legit use: Legacy scripting for automation, Office macros, Windows tasks.
    - Attack use: Malicious macros, phishing attachments, persistence scripts.
- Windows Group Policy (GPO):
    - Legit use: Centralized configuration of domain-joined systems (policies, permissions, security settings).
    - Attack use: Modify/push malicious scripts, disable defenses, or deploy malware across domain.
- Windows AppLocker:
    - Legit use: Application whitelisting (restrict apps by publisher, path, or hash).
    - Attack use: Bypass restrictions via LOLBins, alternate interpreters, or misconfigurations.
