# NMap

Default Nmap scan (nmap <ip>) is TCP Connect Scan (Full Open Scan)


Host discovery (active/live hosts) - Ping Scan (s-scan type, n-skip dns resolution)
- ICMP Echo (ping sweep): nmap -sn -PE <ip/range>
- ICMP Timestamp: nmap -sn -PP <ip>
- ICMP Address Map: nmap -sn -PM <ip>
- ARP (preferred): nmap -sn -PR <ip>
- UDP: nmap -sn –PU <ip>
- TCP SYN (passive): nmap -sn –PS <ip>
- TCP ACK: nmap -sn –PA <ip>
- IP Protocol: nmap -sn –PO <ip>


Port Scan
- TCP Scan
    - Open TCP (detects when port is open after completing three-way handshake)
        - TCP Connect/Full Open: nmap -sT -v <ip>
    - Stealth TCP (abruptly resetting TCP connection between client/server before completion of three-way handshake signals - to bypass firewall rules as well as logging mechanisms)
        - Half-Open: nmap -sS -v <ip>
        - Inverse TCP Flag (avoids many IDS & logging systems, highly stealthy - works on UNIX platform only)
            - Xmas Scan: nmap -sX -v <ip>
            - FIN Scan: nmap -sF -v <ip>
            - NULL Scan: nmap -sN -v <ip>
            - Maimon Scan: nmap -sM -v <ip>
        - ACK Flag Probe: nmap -sA -v <ip>
            - TTL-based Scan (If TTL value of RST packet on a port is below 64, port is open else closed): nmap -sA -ttl 100 -v <ip>
            - Window Scan (older system): nmap -sA -sW -v <ip>
    - 3rd Party & Spoofed TCP (impersonate another computer via spoofing)
        - IDLE/IPID Header Scan: nmap -Pn -p --sl <ip> <ip>
- UDP Scan: nmap -sU -v <ip>
- SCTP Scan
    - SCTP INIT (stealthy & unobtrusive): nmap -sY -v <ip>
    - SCTP Cookie ECHO: nmap -sZ -v <ip>
- IPv6 Scan: nmap -6 <ip>


Service Version Discovery




-------------------------------------------

- OS detection: nmap -O <ip>
- OS+Service Version: nmap -O -sV <ip>
- nmap -T4 -A -v <ip>
