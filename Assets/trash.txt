
Enumerating S3 Buckets

Simple storage service (S3) is a scalable cloud storage service used by Amazon AWS, where files, folders, and objects are stored via Web APIs. Customers and end users utilize S3 services to store text documents, PDFs, videos, and images. To store all these data, the user must create a bucket with a unique name. Attackers can exploit misconfigurations in the bucket implementations and breach security mechanisms to compromise data privacy. Leaving the S3 bucket session enables attackers to modify files (in JavaScript or related code) and inject malware into the bucket files. Attackers often attempt to determine the bucket location and name to test its security and identify vulnerabilities during bucket implementation. Attackers use tools such as CloudBrute, S3Scanner, Bucket Flaws, and BucketLoot to identify open S3 buckets of cloud services, such as Amazon AWS, and retrieve their content for malicious purposes. 


Listed below are several techniques that attackers employ in identifying AWS S3 buckets:

▪ Inspecting HTML
Attackers attempt to perform HTML source code analysis to gather information about S3 buckets. Analyzing the source code of HTML webpages in the background allows attackers to find URLs in the target S3 buckets.

▪ Brute-forcing URL
Because each S3 bucket is assigned a unique identification number, attackers can perform brute-force attacks on the target bucket to identify the correct bucket URL. For example, assume the URL http://s3.amazonaws.com/[bucket_name]; attackers attempt all possibilities for bucket_name to identify the exact URL targeting the bucket. Attackers use tools such as Burp Suite (Burp Intruder) to perform brute-force attacks on S3 buckets.

▪ Advanced Google Hacking
Attackers use advanced Google search operators, such as “inurl”, to search for URLs related to the target S3 buckets. Some Google Dorks used by attackers to identify the URLs of target S3 buckets include the following:
o inurl: s3.amazonaws.com
o inurl: s3.amazonaws.com/audio/
o inurl: s3.amazonaws.com/video/
o inurl: s3.amazonaws.com/backup/
o inurl: s3.amazonaws.com/movie/
o inurl: s3.amazonaws.com/image/

Additionally, attackers can identify the URLs of the target S3 buckets associated with a specific domain or organization using the following Google Dorks:
o site:s3.amazonaws.com inurl:facebook
o site:s3.amazonaws.com intitle:facebook
o inurl:"s3.amazonaws.com" intext:"facebook"
o inurl:"s3.amazonaws.com" "facebook"
o site:s3.amazonaws.com "facebook"
